import{r as M,b as T,n as E,p as R,q as G,a as U,s as $,d as H,E as y,e as c,v as I,o as V,c as q,g as a,w as l,h as n,m as b,f as x,x as K}from"./index-ae78a8db.js";const W=m=>{const g=M(null),e=T({form:{...m}}),t=E(),s=()=>{const{form:p}=t.query;typeof p=="string"&&(e.form=Object.assign(e.form,JSON.parse(p)))},d=()=>{g.value.resetFields()};return R(()=>{s()}),{formRef:g,...G(e),handleFormReset:d}},F=1,O=10,D=0,X=m=>{const{form:g,request:e}=m,t=T({table:{list:[],loading:!1},paging:{pageNo:F,pageSize:O,totalNum:D}}),s=E(),d=U(),p=s.path,C=()=>{p===s.path&&d.replace({query:{...s.query,form:JSON.stringify(g),paging:JSON.stringify(t.paging)}})},v=()=>{const{paging:i}=s.query;typeof i=="string"&&(t.paging=Object.assign(t.paging,JSON.parse(i)))},_=async()=>{var i,r;try{t.table.loading=!0;const o=await e({paging:t.paging});t.table.list=(i=o==null?void 0:o.list)!=null?i:[],t.paging.totalNum=(r=o==null?void 0:o.totalNum)!=null?r:D}finally{t.table.loading=!1,C()}},N=()=>{t.paging.pageNo=F,t.paging.pageSize=O},S=i=>{t.paging.pageNo=1,t.paging.pageSize=i,_()},z=i=>{t.paging.pageNo=i,_()};return R(()=>{v()}),{...G(t),handleGetTableList:_,handlePagingReset:N,handlePagingPageSizeChange:S,handlePagingPageCurrentChange:z}},Y=async m=>{const g=await $.request({method:"POST",url:"/api/getRoleList/v1.0",data:m});return g.list.forEach(e=>{e.state===0?e.stateStr="禁用":e.state===1&&(e.stateStr="正常")}),g},Z={class:"listPage"},ee={class:"content"},te={class:"operation"},ne=H({__name:"index",setup(m){const{formRef:g,form:e,handleFormReset:t}=W({name:void 0,state:void 0}),{table:s,paging:d,handleGetTableList:p,handlePagingReset:C,handlePagingPageSizeChange:v,handlePagingPageCurrentChange:_}=X({form:e.value,async request({paging:r}){var o;try{const u=await Y({...e.value,pageNo:r.pageNo,pageSize:r.pageSize});return{list:u.list,totalNum:u.totalNum}}catch(u){console.log("%c 获取列表数据失败==========>","color: #4FC08D; font-weight: bold",u),y({type:"error",message:(o=u.message)!=null?o:"获取列表数据失败"})}}}),N=()=>{t(),C(),p()},S=()=>{y({type:"info",message:"点击创建按钮"})},z=r=>{console.log("%c 当前点击的行==========>","color: #4FC08D; font-weight: bold",r),y({type:"info",message:"点击编辑按钮"})},i=r=>{console.log("%c 当前点击的行==========>","color: #4FC08D; font-weight: bold",r),y({type:"info",message:"点击删除按钮"})};return R(()=>{p()}),(r,o)=>{const u=c("el-input"),P=c("el-form-item"),w=c("el-option"),J=c("el-select"),h=c("el-button"),L=c("el-form"),k=c("el-table-column"),B=c("el-table"),Q=c("el-pagination"),j=I("loading");return V(),q("div",Z,[a(L,{ref_key:"formRef",ref:g,class:"form",model:n(e),inline:""},{default:l(()=>[a(P,{label:"名称",prop:"name"},{default:l(()=>[a(u,{modelValue:n(e).name,"onUpdate:modelValue":o[0]||(o[0]=f=>n(e).name=f),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1}),a(P,{label:"状态",prop:"state"},{default:l(()=>[a(J,{modelValue:n(e).state,"onUpdate:modelValue":o[1]||(o[1]=f=>n(e).state=f),placeholder:"请选择",clearable:""},{default:l(()=>[a(w,{label:"正常",value:1}),a(w,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),a(P,null,{default:l(()=>[a(h,{type:"primary",loading:n(s).loading,onClick:n(p)},{default:l(()=>[b("搜索")]),_:1},8,["loading","onClick"]),a(h,{loading:n(s).loading,onClick:N},{default:l(()=>[b("重置")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),x("div",ee,[x("div",te,[a(h,{type:"primary",onClick:S},{default:l(()=>[b("创建")]),_:1})]),K((V(),q("div",null,[a(B,{data:n(s).list,stripe:""},{default:l(()=>[a(k,{label:"名称",align:"center",prop:"name"}),a(k,{label:"状态",align:"center",prop:"stateStr"}),a(k,{label:"操作",align:"center"},{default:l(f=>[a(h,{type:"primary",link:"",onClick:A=>z(f.row)},{default:l(()=>[b("编辑")]),_:2},1032,["onClick"]),a(h,{type:"primary",link:"",onClick:A=>i(f.row)},{default:l(()=>[b("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(Q,{class:"pagination",layout:"total, prev, pager, next, sizes",background:!0,"current-page":n(d).pageNo,"page-size":n(d).pageSize,total:n(d).totalNum,"page-sizes":[5,10,20,50,100],onSizeChange:n(v),onCurrentChange:n(_)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])),[[j,n(s).loading]])])])}}});export{ne as default};
